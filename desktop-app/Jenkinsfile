@Library("jenkins_library") _

pipeline {
  agent any
  // *** Documentation ***
  // name: test-electron-app-ci
  // description: 'Builds and packages an Electron application using Windows build agent.'
  stages {
    stage ("Install, Test and Archive") {
      steps {
        echo "Building...built-in agent"
        sh '''
          hostname
        '''
        // dir('desktop-app') {
        //   stash 'source'
        // }
        // sh '''
        //   cd desktop-app
        //   npm install
          
        // '''
      }
    }

    stage ("Build and Package") {
      agent {
        label 'windows-agent'
      }
      steps {
        echo "Packaging...Windows agent"
        sh '''
          hostname
          cd desktop-app
          npm install
          npm run make
          ls
        '''
        // unstash 'source'
        // sh '''
        //   ls
        // '''
        // TODO: cleanup the agent workspace
      }
    }

    stage ("Deploy") {
      steps {
        echo "Packaging...built-in agent"
      }
    }
  }
}
